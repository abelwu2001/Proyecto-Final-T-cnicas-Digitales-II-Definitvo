<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>bcm2835: SMI bus support</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">bcm2835
   &#160;<span id="projectnumber">1.75</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SMI bus support</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga4fe19c2d533c677250d697054d25c84c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__smi.html#ga4fe19c2d533c677250d697054d25c84c">bcm2835_smi_begin</a> (void)</td></tr>
<tr class="separator:ga4fe19c2d533c677250d697054d25c84c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad52ab4c320aaaf0fa1444e30940179ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__smi.html#gad52ab4c320aaaf0fa1444e30940179ee">bcm2835_smi_end</a> (void)</td></tr>
<tr class="separator:gad52ab4c320aaaf0fa1444e30940179ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade9f2a4ae7767891c730546e06ed64c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__smi.html#gade9f2a4ae7767891c730546e06ed64c7">bcm2835_smi_set_timing</a> (uint32_t smichannel, uint32_t readchannel, uint32_t setupcycles, uint32_t strobecycles, uint32_t holdcycles, uint32_t pacecycles)</td></tr>
<tr class="separator:gade9f2a4ae7767891c730546e06ed64c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad24ed3cc5baa222464a120a749ac7c08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__smi.html#gad24ed3cc5baa222464a120a749ac7c08">bcm2835_smi_write</a> (uint32_t smichannel, uint8_t data, uint32_t address)</td></tr>
<tr class="separator:gad24ed3cc5baa222464a120a749ac7c08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e7b3fdf8dee898b821425517e225e0a"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__smi.html#ga0e7b3fdf8dee898b821425517e225e0a">bcm2835_smi_read</a> (uint32_t smichannel, uint32_t address)</td></tr>
<tr class="separator:ga0e7b3fdf8dee898b821425517e225e0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Allows access to SMI bus </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga4fe19c2d533c677250d697054d25c84c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4fe19c2d533c677250d697054d25c84c">&#9670;&nbsp;</a></span>bcm2835_smi_begin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int bcm2835_smi_begin </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start SMI operations. Forces RPi SMI pins P1-19 (MOSI), P1-21 (MISO), P1-23 (CLK), P1-24 (CE0) and P1-26 (CE1) to alternate function ALT1, which enables those pins for SMI interface. You should call <a class="el" href="group__smi.html#gad52ab4c320aaaf0fa1444e30940179ee">bcm2835_smi_end()</a> when all SMI functions are complete to return the pins to their default functions. Only address bits SA0 to SA3 are available as RPi uses GPIO0 (SA5) and GPIO1 (SA4) for I2C HAT identification EEPROM access </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__smi.html#gad52ab4c320aaaf0fa1444e30940179ee">bcm2835_smi_end()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>1 if successful, 0 otherwise (perhaps because you are not running as root) </dd></dl>

</div>
</div>
<a id="gad52ab4c320aaaf0fa1444e30940179ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad52ab4c320aaaf0fa1444e30940179ee">&#9670;&nbsp;</a></span>bcm2835_smi_end()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bcm2835_smi_end </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>End SMI operations. SMI pins P1-19 (MOSI), P1-21 (MISO), P1-23 (CLK), P1-24 (CE0) and P1-26 (CE1) are returned to their default INPUT behaviour. </p>

</div>
</div>
<a id="ga0e7b3fdf8dee898b821425517e225e0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0e7b3fdf8dee898b821425517e225e0a">&#9670;&nbsp;</a></span>bcm2835_smi_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t bcm2835_smi_read </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>smichannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads one byte from SMI bus. Uses polled transfer as described in BCM 2835 ARM Peripherals manual </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">smichannel</td><td>SMI configuration slot to use (0 to 3) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">address</td><td>The address to read from </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value read from SMI bus </dd></dl>
<dl class="section see"><dt>See also</dt><dd>bcm2835_smi_readnb() </dd></dl>

</div>
</div>
<a id="gade9f2a4ae7767891c730546e06ed64c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gade9f2a4ae7767891c730546e06ed64c7">&#9670;&nbsp;</a></span>bcm2835_smi_set_timing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bcm2835_smi_set_timing </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>smichannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>readchannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>setupcycles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>strobecycles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>holdcycles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>pacecycles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Setup SMI bus cycle timing parameters There are four SMI channels for read operation and four channels for write operation Cycles are expressed as multiple of 8ns Note that Pace cycles are not used (no effect on hardware) but they are required for configuration. It is recommended to set this value to 1 (and not 0) to have the smallest cycle in case the hardware would recognize it </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">smichannel</td><td>SMI configuration slot to setup (0 to 3) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">readchannel</td><td>Set to 1 to configure the read channel (0 = configure write channel) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">setupcycles</td><td>Time between address assertion on bus and OE/WR signal assertion </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">strobecycles</td><td>Duration of OE/WR signal assertion </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">holdcycles</td><td>Time after OE/WR deassertion before address is deasserted </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pacecycles</td><td>Time before next SMI bus cycle </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad24ed3cc5baa222464a120a749ac7c08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad24ed3cc5baa222464a120a749ac7c08">&#9670;&nbsp;</a></span>bcm2835_smi_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bcm2835_smi_write </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>smichannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Transfers one byte to SMI bus. Uses polled transfer as described in BCM 2835 ARM Peripherals manual </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">timingslot</td><td>SMI configuration slot to use (0 to 3) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>The data byte to write </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">address</td><td>The address to write to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>bcm2835_smi_writenb() </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
